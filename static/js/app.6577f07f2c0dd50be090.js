webpackJsonp([1],{0:function(e,t){},1:function(e,t){},2:function(e,t){},"4Fqj":function(e,t){},"9h7R":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var c=n("VU/8")({name:"App"},l,!1,function(e){n("4Fqj")},null,null).exports,o=n("/ocq"),r=n("7t+N"),i=n.n(r),s=n("uXZL"),u=n.n(s),h=n("t4zo"),d=n.n(h),p=[null],f={name:"ImportExcel",data:function(){return{checkedTableNames:p,checkAll:!1,excelMsg:[null],tableNames:p,isIndeterminate:!0}},mounted:function(){var e=this;i()("#excel-file").change(function(t){console.log("ss",e);var n=t.target.files,a=new FileReader;a.onload=function(t){console.log(t,"ev");try{var n=t.target.result,a=u.a.read(n,{type:"binary"}),l=[]}catch(e){return void console.log("文件类型不正确")}var c="";for(var o in a.Sheets)if(a.Sheets.hasOwnProperty(o)){c=a.Sheets[o]["!ref"],console.log(c),l=l.concat(u.a.utils.sheet_to_json(a.Sheets[o]));break}for(var r in console.log(l),p=[null],l[0])p.push(r);for(var i in console.log("tt",p),e.tableNames=p,l){var s=parseInt(i)+1;for(var h in l[i].msg=s+"尊敬的"+l[i].姓名+"家长，以下是您孩子本次月考成绩：",l[i])h.indexOf("班座")<0&&h.indexOf("姓名")<0&&(l[i].msg=l[i].msg+h+" "+l[i][h]+"  ")}e.excelMsg=l},a.readAsBinaryString(n[0])})},methods:{handleCheckAllChange:function(e){this.checkedTableNames=e?p:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(e){var t=e.length;this.checkAll=t===this.tableNames.length,this.isIndeterminate=t>0&&t<this.tableNames.length},exportToExcel:function(){var e=u.a.utils.table_to_book(document.getElementById("table-content")),t=u.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{d.a.saveAs(new Blob([t],{type:"application/octet-stream"}),"trade-publish.xlsx")}catch(e){console.log(e,t)}return t}}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("input",{attrs:{type:"file",id:"excel-file",value:"file"}}),e._v(" "),n("el-button",{on:{click:e.exportToExcel}},[e._v("导出EXCEL")]),e._v(" "),n("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),n("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),n("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkedTableNames,callback:function(t){e.checkedTableNames=t},expression:"checkedTableNames"}},e._l(e.tableNames,function(t){return n("el-checkbox",{key:t,attrs:{label:t},on:{change:e.handleCheckedCitiesChange}},[e._v(e._s(t))])})),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.excelMsg,id:"table-content",height:"400"}},[e._l(e.checkedTableNames,function(e){return[n("el-table-column",{attrs:{prop:e,label:e}})]}),e._v(" "),n("el-table-column",{attrs:{prop:"msg",label:"提取区(把成绩全部复制到记事本再发)",width:"2000"}})],2)],1)},staticRenderFns:[]};var m=n("VU/8")(f,v,!1,function(e){n("9h7R")},"data-v-521c7b6c",null).exports;a.default.use(o.a);var b=new o.a({routes:[{path:"/",name:"Excel导入",component:m}]}),g=n("zL8q"),k=n.n(g);n("tvR6");a.default.config.productionTip=!1,a.default.use(k.a),new a.default({el:"#app",router:b,components:{App:c},template:"<App/>"})},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.6577f07f2c0dd50be090.js.map